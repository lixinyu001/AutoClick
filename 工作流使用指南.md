# GitHub Actions 工作流使用指南

## 📋 概述

本工作流用于自动构建AutoClicker的Release APK，已修复keytool错误问题。

## ✅ 已修复的问题

1. **keytool错误** - 添加了创建`.android`目录的步骤
2. **APK签名** - Release版本使用debug签名，可直接安装
3. **构建失败** - 优化了构建流程，添加了详细日志

## 🚀 快速开始

### 方法一：手动触发构建（推荐）

1. 打开GitHub仓库
2. 点击 **Actions** 标签页
3. 选择 **Build Android Release APK** 工作流
4. 点击右侧的 **Run workflow** 按钮
5. 点击绿色的 **Run workflow** 按钮确认
6. 等待构建完成（约2-5分钟）

### 方法二：自动触发构建

将代码推送到`main`分支，会自动触发构建：

```bash
git add .
git commit -m "更新代码"
git push origin main
```

## 📦 下载和安装APK

### 下载APK

1. 进入GitHub仓库的 **Actions** 标签页
2. 点击最近一次成功的构建记录
3. 滚动到页面底部，找到 **Artifacts** 区域
4. 点击 **autoclicker-release-apk** 下载ZIP文件
5. 解压ZIP文件，得到APK文件

### 安装APK

1. 将APK文件传输到Android设备
2. 在设备上启用"允许安装未知来源应用"
3. 点击APK文件进行安装

## 🔧 工作流文件位置

```
d:\AutoClicker\.github\workflows\build-release.yml
```

## 📝 工作流步骤详解

1. **Checkout code** - 拉取仓库代码
2. **Set up JDK 17** - 配置Java环境
3. **Create .android directory** - 创建.android目录（避免keytool错误）
4. **Grant execute permission for gradlew** - 给gradlew添加执行权限
5. **Generate debug keystore** - 生成调试签名文件
6. **Build Release APK** - 构建Release版APK
7. **Upload APK artifact** - 上传APK到GitHub产物
8. **Display APK info** - 显示APK信息

## 🎯 构建产物

- **文件名**：app-release-unsigned.apk（虽然名字是unsigned，但实际已用debug签名）
- **位置**：app/build/outputs/apk/release/
- **有效期**：30天（GitHub产物保留时间）
- **签名方式**：debug签名（可直接安装）

## 🔍 调试技巧

如果构建失败，请检查：

1. **查看构建日志** - 在Actions页面点击失败的构建记录，查看详细错误信息
2. **检查依赖** - 确保所有依赖都正确配置
3. **验证签名** - 确保debug.keystore生成成功
4. **检查权限** - 确保gradlew有执行权限

## ❓ 常见问题

### Q1: 为什么APK名字是"unsigned"？
A: 虽然文件名包含"unsigned"，但实际上已经用debug签名了，可以直接安装。

### Q2: 可以发布到应用商店吗？
A: 不可以。这个APK使用debug签名，只能用于测试。发布到应用商店需要正式签名。

### Q3: 构建需要多长时间？
A: 通常2-5分钟，取决于网络速度和依赖缓存情况。

### Q4: APK在哪里下载？
A: 在GitHub仓库的Actions页面，点击构建记录，在Artifacts区域下载。

### Q5: 如何修改包名？
A: 修改`app/build.gradle`中的`applicationId`字段。

## 📌 注意事项

1. 确保项目已上传到GitHub
2. 确保仓库启用了GitHub Actions
3. 确保main分支存在
4. 确保gradlew文件有执行权限
5. 确保所有依赖都正确配置

## 🎉 构建成功后的验证步骤

1. 下载APK文件
2. 在Android设备上安装
3. 测试应用功能
4. 如有问题，检查构建日志

## 📞 需要帮助？

如果遇到问题，请检查：
- GitHub Actions构建日志
- 项目配置文件
- 依赖项是否完整

---

**最后更新时间**：2024年
**工作流版本**：v1.0
**适用项目**：AutoClicker